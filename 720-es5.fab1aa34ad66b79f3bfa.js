!function(){"use strict";function e(t,i){return(e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(t,i)}function t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var a,r=n(e);if(t){var o=n(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return i(this,a)}}function i(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function n(e){return(n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t&&r(e.prototype,t),i&&r(e,i),e}(self.webpackChunkblog=self.webpackChunkblog||[]).push([[720],{60720:function(i,n,r){r.r(n),r.d(n,{WebcamModule:function(){return C}});var s=r(38583),c=r(95987),u=r(79765),g=r(75965),h=r(54242),d=r(37716),l=r(34904),m=["video"],f=["canvas"];function v(e,t){if(1&e){var i=d.EpF();d.TgZ(0,"div",6),d.NdJ("click",function(){return d.CHM(i),d.oxw().rotateVideoInput(!0)}),d.qZA()}}var p,w=function(){function e(t,i,n){a(this,e),this._mimeType=null,this._imageAsBase64=null,this._imageAsDataUrl=null,this._imageData=null,this._mimeType=i,this._imageAsDataUrl=t,this._imageData=n}return o(e,[{key:"imageAsBase64",get:function(){return this._imageAsBase64?this._imageAsBase64:this._imageAsBase64=e.getDataFromDataUrl(this._imageAsDataUrl,this._mimeType)}},{key:"imageAsDataUrl",get:function(){return this._imageAsDataUrl}},{key:"imageData",get:function(){return this._imageData}}],[{key:"getDataFromDataUrl",value:function(e,t){return e.replace("data:".concat(t,";base64,"),"")}}]),e}(),A=((p=function(){function e(){a(this,e),this.width=640,this.height=480,this.videoOptions=e.DEFAULT_VIDEO_OPTIONS,this.allowCameraSwitch=!0,this.captureImageData=!1,this.imageType=e.DEFAULT_IMAGE_TYPE,this.imageQuality=e.DEFAULT_IMAGE_QUALITY,this.imageCapture=new d.vpe,this.initError=new d.vpe,this.imageClick=new d.vpe,this.cameraSwitched=new d.vpe,this.availableVideoInputs=[],this.videoInitialized=!1,this.activeVideoInputIndex=-1,this.mediaStream=null,this.activeVideoSettings=null}return o(e,[{key:"trigger",set:function(e){var t=this;this.triggerSubscription&&this.triggerSubscription.unsubscribe(),this.triggerSubscription=e.subscribe(function(){t.takeSnapshot()})}},{key:"switchCamera",set:function(e){var t=this;this.switchCameraSubscription&&this.switchCameraSubscription.unsubscribe(),this.switchCameraSubscription=e.subscribe(function(e){"string"==typeof e?t.switchToVideoInput(e):t.rotateVideoInput(!1!==e)})}},{key:"ngAfterViewInit",value:function(){var e=this;this.detectAvailableDevices().then(function(){e.switchToVideoInput(null)}).catch(function(t){e.initError.next({message:t}),e.switchToVideoInput(null)})}},{key:"ngOnDestroy",value:function(){this.stopMediaTracks(),this.unsubscribeFromSubscriptions()}},{key:"takeSnapshot",value:function(){var t=this.nativeVideoElement,i={width:this.width,height:this.height};t.videoWidth&&(i.width=t.videoWidth,i.height=t.videoHeight);var n=this.canvas.nativeElement;n.width=i.width,n.height=i.height;var a=n.getContext("2d");a.drawImage(t,0,0);var r=this.imageType?this.imageType:e.DEFAULT_IMAGE_TYPE,o=n.toDataURL(r,this.imageQuality?this.imageQuality:e.DEFAULT_IMAGE_QUALITY),s=null;this.captureImageData&&(s=a.getImageData(0,0,n.width,n.height)),this.imageCapture.next(new w(o,r,s))}},{key:"rotateVideoInput",value:function(e){this.availableVideoInputs&&this.availableVideoInputs.length>1&&this.switchToVideoInput(this.availableVideoInputs[(this.activeVideoInputIndex+(e?1:this.availableVideoInputs.length-1))%this.availableVideoInputs.length].deviceId)}},{key:"switchToVideoInput",value:function(e){this.videoInitialized=!1,this.stopMediaTracks(),this.initWebcam(e,this.videoOptions)}},{key:"videoResize",value:function(){}},{key:"videoWidth",get:function(){var e=this.getVideoAspectRatio();return Math.min(this.width,this.height*e)}},{key:"videoHeight",get:function(){var e=this.getVideoAspectRatio();return Math.min(this.height,this.width/e)}},{key:"videoStyleClasses",get:function(){var e="";return this.isMirrorImage()&&(e+="mirrored "),e.trim()}},{key:"nativeVideoElement",get:function(){return this.video.nativeElement}},{key:"getVideoAspectRatio",value:function(){var e=this.nativeVideoElement;return e.videoWidth&&e.videoWidth>0&&e.videoHeight&&e.videoHeight>0?e.videoWidth/e.videoHeight:this.width/this.height}},{key:"initWebcam",value:function(t,i){var n=this,a=this.nativeVideoElement;if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){var r=e.getMediaConstraintsForDevice(t,i);navigator.mediaDevices.getUserMedia({video:r}).then(function(t){n.mediaStream=t,a.srcObject=t,a.play(),n.activeVideoSettings=t.getVideoTracks()[0].getSettings();var i=e.getDeviceIdFromMediaStreamTrack(t.getVideoTracks()[0]);n.cameraSwitched.next(i),n.detectAvailableDevices().then(function(){n.activeVideoInputIndex=i?n.availableVideoInputs.findIndex(function(e){return e.deviceId===i}):-1,n.videoInitialized=!0}).catch(function(){n.activeVideoInputIndex=-1,n.videoInitialized=!0})}).catch(function(e){n.initError.next({message:e.message,mediaStreamError:e})})}else this.initError.next({message:"Cannot read UserMedia from MediaDevices."})}},{key:"getActiveVideoTrack",value:function(){return this.mediaStream?this.mediaStream.getVideoTracks()[0]:null}},{key:"isMirrorImage",value:function(){if(!this.getActiveVideoTrack())return!1;var t="auto";switch(this.mirrorImage&&("string"==typeof this.mirrorImage?t=String(this.mirrorImage).toLowerCase():this.mirrorImage.x&&(t=this.mirrorImage.x.toLowerCase())),t){case"always":return!0;case"never":return!1}return e.isUserFacing(this.getActiveVideoTrack())}},{key:"stopMediaTracks",value:function(){this.mediaStream&&this.mediaStream.getTracks&&this.mediaStream.getTracks().forEach(function(e){return e.stop()})}},{key:"unsubscribeFromSubscriptions",value:function(){this.triggerSubscription&&this.triggerSubscription.unsubscribe(),this.switchCameraSubscription&&this.switchCameraSubscription.unsubscribe()}},{key:"detectAvailableDevices",value:function(){return new Promise(function(e,t){})}}],[{key:"getMediaConstraintsForDevice",value:function(e,t){var i=t||this.DEFAULT_VIDEO_OPTIONS;return e&&(i.deviceId={exact:e}),i}},{key:"getDeviceIdFromMediaStreamTrack",value:function(t){if(t.getSettings&&t.getSettings()&&t.getSettings().deviceId)return t.getSettings().deviceId;if(t.getConstraints&&t.getConstraints()&&t.getConstraints().deviceId){var i=t.getConstraints().deviceId;return e.getValueFromConstrainDOMString(i)}}},{key:"getFacingModeFromMediaStreamTrack",value:function(t){if(t){if(t.getSettings&&t.getSettings()&&t.getSettings().facingMode)return t.getSettings().facingMode;if(t.getConstraints&&t.getConstraints()&&t.getConstraints().facingMode){var i=t.getConstraints().facingMode;return e.getValueFromConstrainDOMString(i)}}}},{key:"isUserFacing",value:function(t){var i=e.getFacingModeFromMediaStreamTrack(t);return!!i&&"user"===i.toLowerCase()}},{key:"getValueFromConstrainDOMString",value:function(e){if(e){if(e instanceof String)return String(e);if(Array.isArray(e)&&Array(e).length>0)return String(e[0]);if("object"==typeof e){if(e.exact)return String(e.exact);if(e.ideal)return String(e.ideal)}}return null}}]),e}()).\u0275fac=function(e){return new(e||p)},p.\u0275cmp=d.Xpm({type:p,selectors:[["webcam"]],viewQuery:function(e,t){var i;1&e&&(d.Gf(m,7),d.Gf(f,7)),2&e&&(d.iGM(i=d.CRH())&&(t.video=i.first),d.iGM(i=d.CRH())&&(t.canvas=i.first))},inputs:{width:"width",height:"height",videoOptions:"videoOptions",allowCameraSwitch:"allowCameraSwitch",captureImageData:"captureImageData",imageType:"imageType",imageQuality:"imageQuality",trigger:"trigger",switchCamera:"switchCamera",mirrorImage:"mirrorImage"},outputs:{imageCapture:"imageCapture",initError:"initError",imageClick:"imageClick",cameraSwitched:"cameraSwitched"},decls:6,vars:7,consts:[[1,"webcam-wrapper",3,"click"],["autoplay","","muted","","playsinline","",3,"width","height","resize"],["video",""],["class","camera-switch",3,"click",4,"ngIf"],[3,"width","height"],["canvas",""],[1,"camera-switch",3,"click"]],template:function(e,t){1&e&&(d.TgZ(0,"div",0),d.NdJ("click",function(){return t.imageClick.next()}),d.TgZ(1,"video",1,2),d.NdJ("resize",function(){return t.videoResize()}),d.qZA(),d.YNc(3,v,1,0,"div",3),d._UZ(4,"canvas",4,5),d.qZA()),2&e&&(d.xp6(1),d.Tol(t.videoStyleClasses),d.Q6J("width",t.videoWidth)("height",t.videoHeight),d.xp6(2),d.Q6J("ngIf",t.allowCameraSwitch&&t.availableVideoInputs.length>1&&t.videoInitialized),d.xp6(1),d.Q6J("width",t.width)("height",t.height))},directives:[s.O5],styles:['.webcam-wrapper[_ngcontent-%COMP%]{display:inline-block;line-height:0;position:relative}.webcam-wrapper[_ngcontent-%COMP%]   video.mirrored[_ngcontent-%COMP%]{transform:scaleX(-1)}.webcam-wrapper[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{display:none}.webcam-wrapper[_ngcontent-%COMP%]   .camera-switch[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.1);background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAE9UlEQVR42u2aT2hdRRTGf+cRQqghSqihdBFDkRISK2KDfzDWxHaRQHEhaINKqa1gKQhd6EZLN+IidCH+Q0oWIkVRC21BQxXRitVaSbKoJSGtYGoK2tQ/tU1jY5v0c5F54Xl7b/KSO/PyEt+3e5f75p7zzZwzZ74zUEIJJfyfYaEGllQGVAGZlENdBy6Z2cSiYFTSKkkfS/pH/nBF0kFJdUW9AiRVASeAukD8DgNrzOySrwEzng18KaDzALXuG8W3AiStAvqBisBRNg40mtlPxbYCOgvgPO4bncWW+JpVeDQXRQhIygDfA00F5r0XuNfMrgclQFI98DDQCNQA5ZFXqoCWBVp8XwHRHeEqcN7loy/NbHBesyqpQ1KfFj/6nC+ZvFaApFrgPaCZpYVvgCfNbDiRAElNwGFg+RIt/X8H2s2s9wYCJDUAR4HqJX7++RN40MwGpgmQVAH0AQ2BPz4AHHPl8nBOAqtyFWQjsA6oL4Ada81sPDv7uwImod8kvSJp9RyS8O2SXnb/DYVd2Y9VSroQ4ANXJO2WVJmixqh0kzMWwL4LkiqRtDnA4D1zmfE8j9g9AezcnAHaPcfXdbfdnPZ2Yps6+DwAvO/Z1naTdApY7Xng48BDZnY1MpMVQBuw3iXc5Tnb0wBwBPjUzP6eoezuArZ6svM0geJLkvZEYnl3nkntoqROSbckSW2Suj3ZOIangc7GPJuUtNGdFIfmMeavktoSSKiW9LMPw30Q8JqkekmjCbOZRhuclLQjgYSNxUBAj6RyZ9ATgUJpUtJTCSR8vpAEXHAyWK5BXYFIGHOlepSAloUk4NEYgyoknQhEwhFJ0e8h6VSaQeerCb5uZgdi9utxYBNwOUD93hIVXswM4INCi6K9wAszFC2DwLOBDjHbYp59karIUnRdzYy/3ClqVklaUhfwTICj7K25OqA7a4wWagVsm4Me/xzwg2cCqqONFzO7DPxSCAJi436GUBgHHguQD2oTlJ55oSzP9ybccsttSJw1szdjFOSnI/8dTCGZHwcORp4Nx7y3B1iZ8/sm4MW8/Euxg5wIsS/HaAp3zeP4/G7obRDXI4jiTIA22H7Xdc7X+S3A5lC7QBQ357aq3VAjCeSkwUfAJrfvz+R8A9ADLAtZB+TinpjC5JMA+//jwPZZnF8G7J+L8z4IWB/zbG+gIujVWfLBW/NStVMmqaG4POJRsIjix7h8IGnLQuoBbQki5sVAJHyYm7YkNaRRtXwQ8G1cHpX0iKRrgUjYno17Sf0LrQhJUkdCeHWkVITGJI0k1QeS3ikGSUzOyJUJJNznYneuOCnpTldcxa2kP3xJYqOeSDjqZG8ShJLnE8TTuMS6Iyu1BW7djZqkfo9N0QOuYJmYQddfB7RG+gLTNzqAY9FrL+5/nwEbvDdJJe3zzOrhNP3AWRqmk55t3ZcBuj3b2gb0Sbrbo/NNzk7fFzu7s/E5EiC+rrmeQU0Kx2skvRFoOx2ZzlmSdgbsw49JetvtBpk8nM64d/cGbNtJ0s7cGyJlwHeEv+t3nqnLSgPAUOSGyG3AHUxdzqoJbEcvcL+ZTeTeEapzJKxgaeOcc/7Mf06D7kFrguS0VDAMtGadv+E47DT9tcChJej8ISfpD+abgTe45uOkFi8mnQ+JBVQ+d4VXuOptjavcyot8pq86mfwk8LWZnaOEEkoooYQSSojDv8AhQNeGfe0jAAAAAElFTkSuQmCC");background-position:50%;background-repeat:no-repeat;background-size:80%;border-radius:5px;cursor:pointer;height:48px;position:absolute;right:13px;top:10px;transition:background-color .2s ease;width:48px}.webcam-wrapper[_ngcontent-%COMP%]   .camera-switch[_ngcontent-%COMP%]:hover{background-color:rgba(0,0,0,.18)}']}),p.DEFAULT_VIDEO_OPTIONS={facingMode:"environment"},p.DEFAULT_IMAGE_TYPE="image/jpeg",p.DEFAULT_IMAGE_QUALITY=.92,p),S=function(){var e=function e(){a(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[s.ez]]}),e}(),b=["canvas"];function y(e,t){if(1&e&&d._UZ(0,"img",3,4),2&e){var i=d.oxw();d.Q6J("src",i.imageUrl,d.LSH)}}var k=[{path:"",component:function(){var i=function(i){!function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&e(t,i)}(r,i);var n=t(r);function r(e,t){var i;return a(this,r),(i=n.call(this,t))._snapshotTrigger=new u.xQ,i.snapshotTrigger$=i._snapshotTrigger.asObservable(),e.setTitle("Webcam"),i}return o(r,[{key:"showSnapshot",get:function(){return null!=this._image}},{key:"imageUrl",get:function(){return this._image.imageAsDataUrl}},{key:"ngOnInit",value:function(){this._canvas=this._canvasRef.nativeElement}},{key:"takeSnapshot",value:function(){this._snapshotTrigger.next()}},{key:"captureSnapshot",value:function(e){this._image=e;var t=this._canvas.getContext("2d");this._canvas.height=e.imageData.height,this._canvas.width=e.imageData.width;for(var i=0,n=e.imageData.data;i<n.length;i+=4)n[i]=255-n[i],n[i+1]=255-n[i+1],n[i+2]=255-n[i+2],n[i+3]=255;t.putImageData(e.imageData,0,0)}}]),r}(h.H);return i.\u0275fac=function(e){return new(e||i)(d.Y36(l.y),d.Y36(g.O))},i.\u0275cmp=d.Xpm({type:i,selectors:[["app-webcam"]],viewQuery:function(e,t){var i;(1&e&&d.Gf(b,7),2&e)&&(d.iGM(i=d.CRH())&&(t._canvasRef=i.first))},features:[d._Bn([g.O]),d.qOj],decls:4,vars:2,consts:[["captureImageData","true",3,"trigger","imageCapture","imageClick"],[3,"src",4,"ngIf"],["canvas",""],[3,"src"],["snapshot",""]],template:function(e,t){1&e&&(d.TgZ(0,"webcam",0),d.NdJ("imageCapture",function(e){return t.captureSnapshot(e)})("imageClick",function(){return t.takeSnapshot()}),d.qZA(),d.YNc(1,y,2,1,"img",1),d._UZ(2,"canvas",null,2)),2&e&&(d.Q6J("trigger",t.snapshotTrigger$),d.xp6(1),d.Q6J("ngIf",t.showSnapshot))},directives:[A,s.O5],styles:[""],changeDetection:0}),i}()}],I=function(){var e=function e(){a(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[c.Bz.forChild(k)],c.Bz]}),e}(),C=function(){var e=function e(){a(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=d.oAB({type:e}),e.\u0275inj=d.cJS({imports:[[s.ez,I,S]]}),e}()}}])}();